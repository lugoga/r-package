<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 R package | Bundle your codes in Package</title>
  <meta name="description" content="A guide for R package development, writing good documentation and vignettes, writing robust software, cross-platform development, continuous integration tools, and distributing packages via CRAN and GitHub" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 R package | Bundle your codes in Package" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="lugoga.github.com" />
  
  <meta property="og:description" content="A guide for R package development, writing good documentation and vignettes, writing robust software, cross-platform development, continuous integration tools, and distributing packages via CRAN and GitHub" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 R package | Bundle your codes in Package" />
  
  <meta name="twitter:description" content="A guide for R package development, writing good documentation and vignettes, writing robust software, cross-platform development, continuous integration tools, and distributing packages via CRAN and GitHub" />
  

<meta name="author" content="Masumbuko Semba" />
<meta name="author" content="Nyamisi Peter" />
<meta name="author" content="Ismael Kimirei" />


<meta name="date" content="2021-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simply and value your R session with packages</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome Note</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#basic-structure-of-an-r-package"><i class="fa fa-check"></i><b>1.1</b> Basic Structure of an R Package</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#description-file"><i class="fa fa-check"></i><b>1.1.1</b> DESCRIPTION File</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#namespace-file"><i class="fa fa-check"></i><b>1.1.2</b> NAMESPACE File</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#namespace-function-notation"><i class="fa fa-check"></i><b>1.1.3</b> Namespace Function Notation</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#loading-and-attaching-a-package-namespace"><i class="fa fa-check"></i><b>1.1.4</b> Loading and Attaching a Package Namespace</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#the-r-sub-directory"><i class="fa fa-check"></i><b>1.1.5</b> The R Sub-directory</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#the-man-sub-directory"><i class="fa fa-check"></i><b>1.1.6</b> The man Sub-directory</a></li>
<li class="chapter" data-level="1.1.7" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i><b>1.1.7</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>2</b> R package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-package.html"><a href="r-package.html#package-development"><i class="fa fa-check"></i><b>2.1</b> Package Development</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#document"><i class="fa fa-check"></i><b>3.1</b> Document</a></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dependencies"><i class="fa fa-check"></i><b>3.2</b> Dependencies</a></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#special-case"><i class="fa fa-check"></i><b>3.3</b> Special Case</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="installing-the-package.html"><a href="installing-the-package.html"><i class="fa fa-check"></i><b>4</b> Installing the package</a></li>
<li class="chapter" data-level="5" data-path="building-a-data-package.html"><a href="building-a-data-package.html"><i class="fa fa-check"></i><b>5</b> Building a Data Package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="building-a-data-package.html"><a href="building-a-data-package.html#install-devtools-package-in-r"><i class="fa fa-check"></i><b>5.1</b> Install ‘devtools’ package in R</a></li>
<li class="chapter" data-level="5.2" data-path="building-a-data-package.html"><a href="building-a-data-package.html#create-a-new-package"><i class="fa fa-check"></i><b>5.2</b> Create a new package</a></li>
<li class="chapter" data-level="5.3" data-path="building-a-data-package.html"><a href="building-a-data-package.html#edit-description-file"><i class="fa fa-check"></i><b>5.3</b> Edit DESCRIPTION file</a></li>
<li class="chapter" data-level="5.4" data-path="building-a-data-package.html"><a href="building-a-data-package.html#add-your-data"><i class="fa fa-check"></i><b>5.4</b> Add your data</a></li>
<li class="chapter" data-level="5.5" data-path="building-a-data-package.html"><a href="building-a-data-package.html#load-data"><i class="fa fa-check"></i><b>5.5</b> load data</a></li>
<li class="chapter" data-level="5.6" data-path="building-a-data-package.html"><a href="building-a-data-package.html#extract-only-selected-columns"><i class="fa fa-check"></i><b>5.6</b> extract only selected columns</a></li>
<li class="chapter" data-level="5.7" data-path="building-a-data-package.html"><a href="building-a-data-package.html#rename-columns"><i class="fa fa-check"></i><b>5.7</b> rename columns</a></li>
<li class="chapter" data-level="5.8" data-path="building-a-data-package.html"><a href="building-a-data-package.html#change-votes-to-factor-and-self-descriptive"><i class="fa fa-check"></i><b>5.8</b> change votes to factor and self-descriptive</a></li>
<li class="chapter" data-level="5.9" data-path="building-a-data-package.html"><a href="building-a-data-package.html#use-that-data"><i class="fa fa-check"></i><b>5.9</b> use that data!</a></li>
<li class="chapter" data-level="5.10" data-path="building-a-data-package.html"><a href="building-a-data-package.html#document-your-dataset"><i class="fa fa-check"></i><b>5.10</b> Document your dataset</a></li>
<li class="chapter" data-level="5.11" data-path="building-a-data-package.html"><a href="building-a-data-package.html#generate-documentation-files"><i class="fa fa-check"></i><b>5.11</b> Generate documentation files</a></li>
<li class="chapter" data-level="5.12" data-path="building-a-data-package.html"><a href="building-a-data-package.html#congratulations"><i class="fa fa-check"></i><b>5.12</b> Congratulations!</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final.html"><a href="final.html"><i class="fa fa-check"></i><b>6</b> Final</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bundle your codes in Package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-package" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> R package</h1>
<p>When you need to develop a package, you need some tools for that task. Since I am going to illustrate to develop R package inside Rstudio, you ought to know some basic tools required to accomplish the task. Table <a href="r-package.html#tab:tab21">2.1</a> shows the package you need to install them to be able to work smoothly on package development. The version of the software or package is also shown in table <a href="r-package.html#tab:tab21">2.1</a> for you to check the version you have in your machine and whether you need to update them.</p>
<table>
<caption>
<span id="tab:tab21">Table 2.1: </span>Software and Packages
</caption>
<thead>
<tr>
<th style="text-align:left;">
Software/Package
</th>
<th style="text-align:left;">
Version
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<strong>R</strong>
</td>
<td style="text-align:left;">
4.0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Rstudio</strong>
</td>
<td style="text-align:left;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>devtools</code>
</td>
<td style="text-align:left;">
2.3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>usethis</code>
</td>
<td style="text-align:left;">
1.6.3
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>tidyverse</code>
</td>
<td style="text-align:left;">
1.3.0
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>rlang</code>
</td>
<td style="text-align:left;">
0.4.8
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>broom</code>
</td>
<td style="text-align:left;">
0.7.1
</td>
</tr>
</tbody>
</table>
<p>R package development has become substantially easier in recent years with the introduction of a packages like <strong>devtools</strong> <span class="citation">(Wickham, Hester, and Chang <a href="#ref-devtools" role="doc-biblioref">2020</a>)</span> and <strong>usethis</strong> <span class="citation">(Wickham and Bryan <a href="#ref-usethis" role="doc-biblioref">2020</a>)</span>. These packages includes a variety of functions that facilitate software development in R. During package development stages, you will find that some functions you use once (single use) and others are used several times (multiple usage). Table <a href="r-package.html#tab:tab22">2.2</a> highlights some functions and whether are single used and multiple uses during package development</p>
<table>
<caption>
<span id="tab:tab22">Table 2.2: </span>Single and multiple usage of functions
</caption>
<thead>
<tr>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
usage
</th>
<th style="text-align:left;">
Purpose
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>usethis::create_package()</code>
</td>
<td style="text-align:left;">
Single
</td>
<td style="text-align:left;">
Initialize package
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>usethis::use_mit_license()</code>
</td>
<td style="text-align:left;">
Single
</td>
<td style="text-align:left;">
Add license to package
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>usethis::use_pipe()</code>
</td>
<td style="text-align:left;">
Single
</td>
<td style="text-align:left;">
Add pipe function as dependency
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>devtools::check()</code>
</td>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
build package locally and check
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>devtools::load_all()</code>
</td>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
load functions into memory
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>usethis::use_r()</code>
</td>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
create R script for function
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>usethis::use_package()</code>
</td>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
add package dependency
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>devtools::document()</code>
</td>
<td style="text-align:left;">
Multiple
</td>
<td style="text-align:left;">
build and add documentation
</td>
</tr>
</tbody>
</table>
<div id="package-development" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Package Development</h2>
<p>We begin our package development using the function <code>usethis::create_package()</code>, which basically initialize the package development.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="r-package.html#cb5-1"></a>usethis<span class="op">::</span><span class="kw">create_package</span>(<span class="dt">path =</span> <span class="st">&quot;c:/Users/Semba/Desktop/babye&quot;</span>)</span></code></pre></div>
<p>This function create an R project with an environment for package development in a location you specified. For this case I have created a package named <strong>babye</strong> on my desktop. The step-by-step of the process is shown in figure <a href="r-package.html#fig:fig21">2.1</a></p>
<div class="figure"><span id="fig:fig21"></span>
<img src="img/create_package.png" alt="package development" width="100%" />
<p class="caption">
Figure 2.1: package development
</p>
</div>
<p>Now that we have a package. let’s check it. The function <code>devtools::check</code> was developed for this task as it updates the package documentation, build the package and submit over 50 checks for metadata, structure, R code, documentation and more. This can take a while to run, depending on how big your package is. It is helpful to run frequently, especially if you are planning on submitting to CRAN. But even for internal packages, it is still good practice. A screenshot of our first check is shown in figure <a href="r-package.html#fig:fig22">2.2</a> and spotted a single warning that our package needs a license in the DESCRIPTION file</p>
<div class="figure"><span id="fig:fig22"></span>
<img src="img/dev_check.png" alt="Check the package functions" width="100%" />
<p class="caption">
Figure 2.2: Check the package functions
</p>
</div>
<p>We can fix this error by simply add a license on the package project folder. A standard recommendation is the MIT license because of its widely usage and permissions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="r-package.html#cb6-1"></a>usethis<span class="op">::</span><span class="kw">use_mit_license</span>(<span class="dt">name =</span> <span class="st">&quot;Masumbuko Semba&quot;</span>)</span></code></pre></div>
<p>Once we run the <code>usethis::use_mit_license(name = "Masumbuko Semba")</code> in the command line, it updates the description file and creates two new license files in the project folder (see figure <a href="r-package.html#fig:fig23">2.3</a>). It is recommended that the two licenses files never edited.</p>
<div class="figure"><span id="fig:fig23"></span>
<img src="img/add_license.png" alt="Package license" width="100%" />
<p class="caption">
Figure 2.3: Package license
</p>
</div>
<p>Though the tools have added key parts of the DESCTIPTION file, you need to open it and complete the remaining parts and updates the fields with descriptive information. Once you have done that you can re-submit with <code>devtools::check()</code></p>
<div class="figure"><span id="fig:unnamed-chunk-9"></span>
<img src="img/dev_check_clean.png" alt="Package free of error" width="100%" />
<p class="caption">
Figure 2.4: Package free of error
</p>
</div>
<p>We notice that our package is error-free</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-usethis">
<p>Wickham, Hadley, and Jennifer Bryan. 2020. <em>Usethis: Automate Package and Project Setup</em>. <a href="https://CRAN.R-project.org/package=usethis">https://CRAN.R-project.org/package=usethis</a>.</p>
</div>
<div id="ref-devtools">
<p>Wickham, Hadley, Jim Hester, and Winston Chang. 2020. <em>Devtools: Tools to Make Developing R Packages Easier</em>. <a href="https://CRAN.R-project.org/package=devtools">https://CRAN.R-project.org/package=devtools</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-package.pdf", "r-package.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
