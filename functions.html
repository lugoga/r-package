<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Functions | Bundle your codes in Package</title>
  <meta name="description" content="A guide for R package development, writing good documentation and vignettes, writing robust software, cross-platform development, continuous integration tools, and distributing packages via CRAN and GitHub" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Functions | Bundle your codes in Package" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="lugoga.github.com" />
  
  <meta property="og:description" content="A guide for R package development, writing good documentation and vignettes, writing robust software, cross-platform development, continuous integration tools, and distributing packages via CRAN and GitHub" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Functions | Bundle your codes in Package" />
  
  <meta name="twitter:description" content="A guide for R package development, writing good documentation and vignettes, writing robust software, cross-platform development, continuous integration tools, and distributing packages via CRAN and GitHub" />
  

<meta name="author" content="Masumbuko Semba" />
<meta name="author" content="Nyamisi Peter" />
<meta name="author" content="Ismael Kimirei" />


<meta name="date" content="2021-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-package.html"/>
<link rel="next" href="installing-the-package.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simply and value your R session with packages</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome Note</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#basic-structure-of-an-r-package"><i class="fa fa-check"></i><b>1.1</b> Basic Structure of an R Package</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#description-file"><i class="fa fa-check"></i><b>1.1.1</b> DESCRIPTION File</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#namespace-file"><i class="fa fa-check"></i><b>1.1.2</b> NAMESPACE File</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#namespace-function-notation"><i class="fa fa-check"></i><b>1.1.3</b> Namespace Function Notation</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#loading-and-attaching-a-package-namespace"><i class="fa fa-check"></i><b>1.1.4</b> Loading and Attaching a Package Namespace</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#the-r-sub-directory"><i class="fa fa-check"></i><b>1.1.5</b> The R Sub-directory</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#the-man-sub-directory"><i class="fa fa-check"></i><b>1.1.6</b> The man Sub-directory</a></li>
<li class="chapter" data-level="1.1.7" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i><b>1.1.7</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>2</b> R package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-package.html"><a href="r-package.html#package-development"><i class="fa fa-check"></i><b>2.1</b> Package Development</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#document"><i class="fa fa-check"></i><b>3.1</b> Document</a></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#dependencies"><i class="fa fa-check"></i><b>3.2</b> Dependencies</a></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#special-case"><i class="fa fa-check"></i><b>3.3</b> Special Case</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="installing-the-package.html"><a href="installing-the-package.html"><i class="fa fa-check"></i><b>4</b> Installing the package</a></li>
<li class="chapter" data-level="5" data-path="final.html"><a href="final.html"><i class="fa fa-check"></i><b>5</b> Final</a></li>
<li class="chapter" data-level="6" data-path="building-a-data-package.html"><a href="building-a-data-package.html"><i class="fa fa-check"></i><b>6</b> Building a Data Package</a>
<ul>
<li class="chapter" data-level="6.1" data-path="building-a-data-package.html"><a href="building-a-data-package.html#install-devtools-package-in-r"><i class="fa fa-check"></i><b>6.1</b> Install ‘devtools’ package in R</a></li>
<li class="chapter" data-level="6.2" data-path="building-a-data-package.html"><a href="building-a-data-package.html#create-a-new-package"><i class="fa fa-check"></i><b>6.2</b> Create a new package</a></li>
<li class="chapter" data-level="6.3" data-path="building-a-data-package.html"><a href="building-a-data-package.html#edit-description-file"><i class="fa fa-check"></i><b>6.3</b> Edit DESCRIPTION file</a></li>
<li class="chapter" data-level="6.4" data-path="building-a-data-package.html"><a href="building-a-data-package.html#add-your-data"><i class="fa fa-check"></i><b>6.4</b> Add your data</a></li>
<li class="chapter" data-level="6.5" data-path="building-a-data-package.html"><a href="building-a-data-package.html#load-data"><i class="fa fa-check"></i><b>6.5</b> load data</a></li>
<li class="chapter" data-level="6.6" data-path="building-a-data-package.html"><a href="building-a-data-package.html#extract-only-selected-columns"><i class="fa fa-check"></i><b>6.6</b> extract only selected columns</a></li>
<li class="chapter" data-level="6.7" data-path="building-a-data-package.html"><a href="building-a-data-package.html#rename-columns"><i class="fa fa-check"></i><b>6.7</b> rename columns</a></li>
<li class="chapter" data-level="6.8" data-path="building-a-data-package.html"><a href="building-a-data-package.html#change-votes-to-factor-and-self-descriptive"><i class="fa fa-check"></i><b>6.8</b> change votes to factor and self-descriptive</a></li>
<li class="chapter" data-level="6.9" data-path="building-a-data-package.html"><a href="building-a-data-package.html#use-that-data"><i class="fa fa-check"></i><b>6.9</b> use that data!</a></li>
<li class="chapter" data-level="6.10" data-path="building-a-data-package.html"><a href="building-a-data-package.html#document-your-dataset"><i class="fa fa-check"></i><b>6.10</b> Document your dataset</a></li>
<li class="chapter" data-level="6.11" data-path="building-a-data-package.html"><a href="building-a-data-package.html#generate-documentation-files"><i class="fa fa-check"></i><b>6.11</b> Generate documentation files</a></li>
<li class="chapter" data-level="6.12" data-path="building-a-data-package.html"><a href="building-a-data-package.html#congratulations"><i class="fa fa-check"></i><b>6.12</b> Congratulations!</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bundle your codes in Package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functions" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Functions</h1>
<p>As mentioned in previous chapter, R packages bundles functions so that are ready and easy available for users. That tells us that the core ingredients of R packages are functions. R packages contains several functions that together make a packages that is aimed to facilitate data import, manipulation and plotting within R environment <span class="citation">(R Core Team <a href="#ref-R-base" role="doc-biblioref">2020</a>)</span>. Therefore, in this chapter we are going to learn how to make a simple function that work. We are not going to load with you with creating many functions, but we understand that once you master the basic of creating your own function, it will be easy to make more function that are intended to solve a particular data science probem.</p>
<p>We create a function and assign it a name <code>max_min</code>. This function aim to find the difference of numeric values in a vector.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="functions.html#cb7-1"></a>max_min &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb7-2"><a href="functions.html#cb7-2"></a>  <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</span>
<span id="cb7-3"><a href="functions.html#cb7-3"></a>}</span></code></pre></div>
<p>Let’s check whether the function work using the famous iris dataset. We only check the difference of variable <code>Sepal.Length</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="functions.html#cb8-1"></a><span class="kw">max_min</span>(<span class="dt">x =</span> iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] 3.6</code></pre>
<p>That work, what if we use a <code>Species</code> variable</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="functions.html#cb10-1"></a><span class="kw">max_min</span>(<span class="dt">x =</span> iris<span class="op">$</span>Species)</span></code></pre></div>
<p>We get an error, but the message isn’t descriptive. That is common. For us to make descriptive notification when a wrong type of data is provided, we need to add the <code>if-stop</code> function to validity the arguments that are required in the function. We recreate the function and additional arguments to check the validity of the arguments.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="functions.html#cb11-1"></a>max_min &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb11-2"><a href="functions.html#cb11-2"></a>  </span>
<span id="cb11-3"><a href="functions.html#cb11-3"></a>    <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.numeric</span>(x)){</span>
<span id="cb11-4"><a href="functions.html#cb11-4"></a>      <span class="kw">stop</span>(<span class="st">&quot;i am sorry, I can work with a &quot;</span>, <span class="kw">class</span>(x)[<span class="dv">1</span>], <span class="st">&quot; variable you provided, Please supply me with numeric vector variable&quot;</span>)</span>
<span id="cb11-5"><a href="functions.html#cb11-5"></a>    }</span>
<span id="cb11-6"><a href="functions.html#cb11-6"></a>  </span>
<span id="cb11-7"><a href="functions.html#cb11-7"></a>  <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</span>
<span id="cb11-8"><a href="functions.html#cb11-8"></a>  </span>
<span id="cb11-9"><a href="functions.html#cb11-9"></a>}</span></code></pre></div>
<p>Let’s check again the variables species in our functions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="functions.html#cb12-1"></a><span class="kw">max_min</span>(<span class="dt">x =</span> iris<span class="op">$</span>Species)</span></code></pre></div>
<p>Woolah! now we get a descriptive error notification, what if we supply the numeric variable to the function!</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="functions.html#cb13-1"></a><span class="kw">max_min</span>(iris<span class="op">$</span>Sepal.Width)</span></code></pre></div>
<pre><code>## [1] 2.4</code></pre>
<p>Let us add our first function <code>max_min</code> to <strong>babye</strong> package using <code>usethis::use_r("max_min"). This creates a black R script named</code>max_min.R<code>located in the</code>R/` sub-folder in our package directory. It is recommended that the R script and the function bear the same name. Then fill the R script of R function we created with the argument as shown in figure <a href="functions.html#fig:fig31">3.1</a>.</p>
<div class="figure"><span id="fig:fig31"></span>
<img src="img/first_function.png" alt="Function script" width="100%" />
<p class="caption">
Figure 3.1: Function script
</p>
</div>
<p>Once you have created the function, take your function for a test drive with <code>devtools::load_all (“arguably the most important part of the devtools workflow”)</code>. <code>devtools::load_all()</code> places your function in local memory so that you may tinker and confirm its execution. Let’s give it a try.</p>
<div id="document" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Document</h2>
<p>Next document the <code>max_min</code> function using the Roxygen skeleton. The roxygen2 package provides an in-source documentation system that automatically generates R documentation (Rd) files. First, place your cursor in the function definition, and then you can add the skeleton from <code>code &gt; insert Roxygen skeleton</code> in the Rstudio main tab (see figure <a href="functions.html#fig:fig32">3.2</a>).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="functions.html#cb15-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;img/roxygen_skeleton.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:fig32"></span>
<img src="img/roxygen_skeleton.png" alt="Inserting function documentation in Rstuido" width="100%" />
<p class="caption">
Figure 3.2: Inserting function documentation in Rstuido
</p>
</div>
<p>You will get skeleton of documentation for the function, you can fill the field and updates it as you wish. This document the function and briefly describe it, which make it easy for you and user later that help instruct how to use the function. I have updated the <code>max_min</code> function as seen in figure <a href="functions.html#fig:fig33">3.3</a></p>
<div class="figure"><span id="fig:fig33"></span>
<img src="img/first_function_description.png" alt="documented function" width="100%" />
<p class="caption">
Figure 3.3: documented function
</p>
</div>
<p>Once you have update the function document, save it and submit using the <code>devtools::document</code> function.</p>
</div>
<div id="dependencies" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Dependencies</h2>
<p>It’s the job of the DESCRIPTION to list the packages that your package needs to work. To specify a package dependency, the name of the package needs to be listed in the DESCRIPTION file. This can be automatically done for you by submitting.</p>
<div class="figure"><span id="fig:fig34"></span>
<img src="img/package_dependency.png" alt="Package dependency" width="100%" />
<p class="caption">
Figure 3.4: Package dependency
</p>
</div>
<p>We notice that our package to work with pipe operator, it requires a <strong>magritrr</strong> package <span class="citation">(<span class="citeproc-not-found" data-reference-id="R-magritrr"><strong>???</strong></span>)</span>. That means when you install this package, it will also install the packages it depends like <strong>magritrr</strong>.</p>
<div class="figure"><span id="fig:fig35"></span>
<img src="img/package_dependency_description.png" alt="Package dependency" width="100%" />
<p class="caption">
Figure 3.5: Package dependency
</p>
</div>
</div>
<div id="special-case" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Special Case</h2>
<p>Although we have imported a <strong>magritrr</strong> package, this package has special operator called pipe or then denoted as <code>%&gt;%</code>, which provide a convenient way to chain the processes in R. We can add this special function in two steps</p>
<ul>
<li><code>usethis::use_pipe()</code>—which creates <code>utils-pipe.R</code> folder and adds <code>magritrr</code> to imports in the DESCRIPTION file.</li>
<li><code>devtools::document()</code>—add the pipe in our package NAMESPACE file.</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-base">
<p>R Core Team. 2020. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="installing-the-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-package.pdf", "r-package.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
